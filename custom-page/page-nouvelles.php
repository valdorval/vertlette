<?php

/**
 * Template Name: Nouvelles
 */

get_header();
?>

<main>
    <section class="main-blog">
        <div class="flex container-big main-blog__article u-margin-top-big">

            <?php
            // Affiche le dernier post publié
            $the_query = new WP_Query(array(
                'post_type' => 'nouvelles',
                'posts_per_page' => 1,
            ));
            ?>

            <?php
            if ($the_query->have_posts()) :
                while ($the_query->have_posts()) : $the_query->the_post();
            ?>
                    <div class="main-blog__article--text center">
                        <div class="main-blog__center">
                            <!-- deviendrait une categorie -->
                            <p class="p-primary-light center u-margin-bottom-big">Idées de décoration</p>
                            <h2 class="heading-tertiary u-margin-bottom-normal"> <?php echo the_title(); ?> </h2>
                            <p class="main-blog__article--description center u-margin-bottom-normal"> <?php echo the_field('description_de_larticle'); ?></p>
                            <a href="<?php the_permalink($the_query->ID) ?>"><button class="btn">Lire l'article</button></a>
                        </div>
                    </div>
                    <?php
                    $feat_image = wp_get_attachment_url(get_post_thumbnail_id($post->ID));
                    ?>
                    <div class="main-blog__image">
                        <img src="<?php echo $feat_image; ?>" alt="Image de l'article">
                    </div>
            <?php endwhile;
                wp_reset_postdata();
            else :
            endif;
            ?>
        </div>
    </section>

    <section class="blog-articles u-margin-bottom-normal u-margin-top-big">
        <div class="container-big flex blog-articles__content">
            <?php
            // affiche tout les post exepté le dernier publié avec offset
            $args = new WP_Query(array(
                'post_type'             => 'nouvelles',
                'post_per_page'         =>  10,
                'ignore_sticky_posts'   => 1,
                'paged'                 => $paged,
                'offset'                => 1,
            ));

            if ($args->have_posts()) :
                while ($args->have_posts()) : $args->the_post();
                    $feat_image = wp_get_attachment_url(get_post_thumbnail_id($post->ID)); ?>

                    <div class="blog-articles__item u-margin-top-big">
                        <a href="<?php the_permalink($the_query->ID) ?>">
                            <img src="<?php echo $feat_image; ?>">
                            <div class="blog-articles__text">
                                <h3 class="heading-quaternary"> <?php echo the_title(); ?> </h3>
                                <p class="p-light"> <?php echo the_field('description_de_larticle'); ?></p>
                            </div>
                        </a>
                    </div>
            <?php
                endwhile;
            endif;
            ?>
        </div>
    </section>

    <section class="archives u-margin-bottom-big">
        <h4 class="container-big heading-secondary heading-secondary--dark u-margin-bottom-normal">Archives</h4>
        <div class="archives__content">
            <div class="archives__content--box container-big flex">
                <div class="archives__content--menu">
                    <h5 class="heading-rubik--black u-margin-bottom-small">Récents</h5>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                </div>
                <div class="archives__content--menu">
                    <h5 class="heading-rubik--black u-margin-bottom-small">Catégories</h5>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                </div>
                <div class="archives__content--menu">
                    <h5 class="heading-rubik--black u-margin-bottom-small">Tags</h5>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                </div>
                <div class="archives__content--menu">
                    <h5 class="heading-rubik--black u-margin-bottom-small">Mois</h5>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                </div>
                <div class="archives__content--menu">
                    <h5 class="heading-rubik--black u-margin-bottom-small">Année</h5>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                    <p class="u-margin-bottom-xsmall"><a href="#">Lorem ipsum dolor sit amet</a></p>
                </div>
            </div>
        </div>
    </section>
</main>
<?php
get_footer();
?>
